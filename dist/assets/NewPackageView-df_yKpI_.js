import{d as A,r as p,h as g,x as B,a as i,b as o,i as b,w as j,j as x,H as F,F as k,G as C,k as M,c as E,f as N,z as $,o as n,A as D,t as V,p as L,m as O,_ as U}from"./index-CVMiIcLg.js";import{_ as G}from"./valley_route_graph-CgP9BmlN.js";import{P as R,E as z,S as H}from"./SuccessAlert-D4EoaIXj.js";import{p as P}from"./packages-CDTiZh1H.js";import{v as J}from"./validateField-BHAg92NY.js";const t=v=>(L("data-v-025625f0"),v=v(),O(),v),K={class:"container mx-auto pt-5"},Q={class:"home mb-3"},W=t(()=>o("i",{class:"bi bi-house-fill"},null,-1)),X=t(()=>o("h1",null,"Crea un nuevo paquete",-1)),Y={key:0,class:"packages flex flex-wrap gap-5 my-5"},Z={class:"new-package"},ee=t(()=>o("p",{class:"mt-3 mb-1"},"Node de origen",-1)),oe=t(()=>o("option",{value:"",disabled:"",selected:""},"Selecciona un nodo de origen",-1)),se=["value"],ae=t(()=>o("p",{class:"mt-3 mb-1"},"Node de destino",-1)),te=t(()=>o("option",{value:"",disabled:"",selected:""},"Selecciona un nodo de origen",-1)),ne=["value"],re={key:1},le=t(()=>o("p",null,"Cargando...",-1)),ie=[le],de=t(()=>o("h2",{class:"mt-3"},"Puntos de control",-1)),ce=t(()=>o("p",{class:"mb-5 mt-1"},"Estas son las rutas con las que cuenta la empresa",-1)),ue=t(()=>o("img",{src:G,alt:"Checkpoints"},null,-1)),pe=t(()=>o("p",{class:"text-base mt-1"},"A partir de Google Earth",-1)),me={class:"pages flex my-5 gap-5 flex-wrap"},ve=A({__name:"NewPackageView",setup(v){const y=p(!0),h=p([]),d=g({description:""}),_=g({description:!1}),w=g({description:""}),m=g({description:!1}),a=p({nodeFrom:"",nodeTo:""}),l=p(""),c=p(""),u=p(!1),S=r=>{r==="all"&&Object.keys(m).forEach(e=>{m[e]=!0}),m[r]=!0,Object.keys(d).forEach(e=>{if(m[e]){const f=J("newpackage",e,d[e]);f!==""?(_[e]=!0,w[e]=f):(_[e]=!1,w[e]="")}})},T=()=>!(Object.values(_).filter(e=>e===!0).length>0),q=async()=>{if(u.value=!0,S("all"),!T()){u.value=!1;return}if(a.value.nodeFrom===""||a.value.nodeTo===""){u.value=!1,l.value="Selecciona un nodo de origen y destino";return}else if(a.value.nodeFrom===a.value.nodeTo){u.value=!1,l.value="El nodo de origen y destino no pueden ser iguales";return}const r={description:d.description,start_node_id:a.value.nodeFrom,end_node_id:a.value.nodeTo};try{await P.createPackage(r),c.value="Paquete creado correctamente",d.description="",a.value.nodeFrom="",a.value.nodeTo=""}catch{l.value="Error al crear el paquete"}finally{u.value=!1}},I=async()=>{try{h.value=await P.getNodesList()}catch(r){console.error(r)}finally{y.value=!1}};return B(async()=>{await I()}),(r,e)=>{const f=$("router-link");return n(),i(k,null,[o("div",K,[o("div",Q,[b(f,{to:"/"},{default:j(()=>[W,D(" Inicio ")]),_:1})]),X,y.value?(n(),i("div",re,ie)):(n(),i("div",Y,[o("div",Z,[b(R,{label:"DescripciÃ³n",id:"description",type:"text",placeholder:"",modelValue:d.description,"onUpdate:modelValue":e[0]||(e[0]=s=>d.description=s),error:_.description&&m.description,errorMessage:w.description,onLossFocus:e[1]||(e[1]=s=>S("description"))},null,8,["modelValue","error","errorMessage"]),ee,x(o("select",{name:"nodeFrom",id:"node-from","onUpdate:modelValue":e[2]||(e[2]=s=>a.value.nodeFrom=s),class:"form-select border border-gray-300"},[oe,(n(!0),i(k,null,C(h.value,s=>(n(),i("option",{key:s.id,value:s.id},V(s.name),9,se))),128))],512),[[F,a.value.nodeFrom]]),ae,x(o("select",{name:"nodeFrom",id:"node-from","onUpdate:modelValue":e[3]||(e[3]=s=>a.value.nodeTo=s),class:"form-select border border-gray-300"},[te,(n(!0),i(k,null,C(h.value,s=>(n(),i("option",{key:s.id,value:s.id},V(s.name),9,ne))),128))],512),[[F,a.value.nodeTo]])])])),de,ce,ue,pe,o("div",me,[b(M,{text:"Crear paquete",onClick:q,loading:u.value},null,8,["loading"])])]),l.value&&c.value===""?(n(),E(z,{key:0,show:l.value!=="",message:l.value,onClose:e[4]||(e[4]=s=>l.value="")},null,8,["show","message"])):N("",!0),c.value?(n(),E(H,{key:1,show:c.value!=="",message:c.value,onClose:e[5]||(e[5]=s=>c.value="")},null,8,["show","message"])):N("",!0)],64)}}}),be=U(ve,[["__scopeId","data-v-025625f0"]]);export{be as default};
